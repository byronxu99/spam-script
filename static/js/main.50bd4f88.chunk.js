(this["webpackJsonpspam-script"]=this["webpackJsonpspam-script"]||[]).push([[0],{103:function(e,a,t){e.exports=t(209)},108:function(e,a,t){},14:function(e,a,t){"use strict";(function(e){var n,l;t.d(a,"b",(function(){return r})),t.d(a,"c",(function(){return m})),t.d(a,"a",(function(){return o}));var r=window.location.hostname.includes("mit.edu"),c=(null===(n=e)||void 0===n||null===(l=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}))||void 0===l?void 0:l.NODE_ENV)&&!1;function s(e){e.preventDefault(),e.returnValue=!1}var i=!1;function m(){i||c||(window.addEventListener("beforeunload",s),i=!0)}function o(){i&&(window.removeEventListener("beforeunload",s),i=!1)}}).call(this,t(79))},168:function(e,a){},209:function(e,a,t){"use strict";t.r(a);var n=t(0),l=t.n(n),r=t(42),c=t.n(r),s=(t(108),t(11)),i=t(7),m=t(98);function o(){return l.a.createElement("footer",{className:"footer"},l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"level has-text-centered"},l.a.createElement("div",{className:"level-item"},l.a.createElement("a",{href:"https://esp.mit.edu",target:"_blank",rel:"noopener noreferrer",className:"has-text-grey-dark"},"MIT ESP Email Spam Script")),l.a.createElement("div",{className:"level-item"},l.a.createElement("a",{href:"https://github.com/byronxu99/spam-script",target:"_blank",rel:"noopener noreferrer",className:"has-text-grey-dark"},l.a.createElement("span",{className:"icon"},l.a.createElement(i.a,{icon:m.a,fixedWidth:!0,transform:"down-1"}))," ","Open Source")),l.a.createElement("div",{className:"level-item"},l.a.createElement("a",{href:"https://scripts.mit.edu",target:"_blank",rel:"noopener noreferrer",className:"has-text-grey-dark"},"Powered by scripts.mit.edu")))))}var u=t(14);function d(e){return l.a.createElement(l.a.Fragment,null,l.a.createElement("section",{className:"hero is-fullheight"},l.a.createElement("div",{className:"hero-body"},l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"title is-1 has-text-centered"},"Welcome to the new spam script!"),l.a.createElement("div",{className:"columns is-desktop py-5"},l.a.createElement("div",{className:"column has-text-centered px-2"},l.a.createElement("div",{className:"huge-icon"},l.a.createElement("span",{role:"img","aria-label":"icon"},"\ud83d\udccb")),l.a.createElement("p",{className:"title is-3 py-1"},"Enter your data"),l.a.createElement("p",{className:"subtitle is-5 py-2 px-5"},"Copy and paste tab-separated or comma-separated values from a spreadsheet.")),l.a.createElement("div",{className:"column has-text-centered px-2"},l.a.createElement("div",{className:"huge-icon"},l.a.createElement("span",{role:"img","aria-label":"icon"},"\u270f\ufe0f")),l.a.createElement("p",{className:"title is-3 py-1"},"Write your message"),l.a.createElement("p",{className:"subtitle is-5 py-2 px-5"},"Draft a Markdown, HTML, or plain-text email template, featuring instant preview")),l.a.createElement("div",{className:"column has-text-centered px-2"},l.a.createElement("div",{className:"huge-icon"},l.a.createElement("span",{role:"img","aria-label":"icon"},"\u2709\ufe0f")),l.a.createElement("p",{className:"title is-3 py-1"},"Send your spam"),l.a.createElement("p",{className:"subtitle is-5 py-2 px-5"},"Double-check all your messages and go! View live progress as each message sends."))),l.a.createElement("div",{className:"has-text-centered py-4"},l.a.createElement("button",{onClick:e.nextPage,className:"button is-success is-large px-6"},"Get started")),u.b&&l.a.createElement("div",{className:"has-text-centered py-1"},l.a.createElement("a",{href:"https://esp.scripts.mit.edu:444/esp-publicity/email/email-dictator/web/edit.cgi"},"Looking for the old spam script? Click here."))))),l.a.createElement(o,null))}var E,p=t(2),h=t(20),f=t(100),v=t.n(f),g=Object(h.b)({name:"data",initialState:{},reducers:{setRawData:function(e,a){e.raw=a.payload},setParsedData:function(e,a){e.headers=a.payload.headers,e.rows=a.payload.rows}}}),N=g.reducer,b=g.actions,y=b.setRawData,w=b.setParsedData;function x(e){return function(a){a(y(e));var t,n=v.a.parse(e,{skipEmptyLines:"greedy"}),l={headers:(t={headers:n.data[0]||[],rows:n.data.slice(1)}).headers.map((function(e){return e.trim()})),rows:t.rows.map((function(e){return e.map((function(e){return e.trim()}))}))};a(w(l))}}function S(e){return e.data.raw||""}function P(e){return{headers:e.data.headers||[],rows:e.data.rows||[]}}!function(e){e[e.MARKDOWN=0]="MARKDOWN",e[e.HTML=1]="HTML",e[e.PLAINTEXT=2]="PLAINTEXT",e[e.PROCESSED=3]="PROCESSED"}(E||(E={}));var O=t(21),A=t(22),j=t(101),T=t.n(j),k=t(76),C=t.n(k),D=t(77),M=t.n(D),R={smartLists:!0,smartypants:!0,xhtml:!0},I={hideLinkHrefIfSameAsText:!0,tables:!0},U=["ARGV"];function G(e){return e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&")}function _(e,a){var t=e.headers,n=e.rows[a]||[],l={};return t.forEach((function(e,a){e&&(l[e]=n[a]||"")})),l.ARGV=n,l}function F(e){var a={from:H(e.from),sender:H(e.sender),to:H(e.to),cc:H(e.cc),bcc:H(e.bcc),replyTo:H(e.replyTo),inReplyTo:H(e.inReplyTo),references:H(e.references),subject:H(e.subject),messageId:H(e.messageId),date:H(e.date)},t=H(e.raw),n=H(e.attachmentNames);return function(l){var r,c,s={host:e.host,bodyFormat:e.bodyFormat,attachments:[],errors:e.errors||[]};for(var i in a){var m,o=i,u=a[o];if("function"===typeof u)try{var d=u(l);d&&(s[o]=d)}catch(g){var p;null===(p=s.errors)||void 0===p||p.push(L(g,'Error in field "'.concat(i,'"')))}else null===(m=s.errors)||void 0===m||m.push(L(u,'Error in field "'.concat(i,'"')))}if("function"===typeof t)try{s.raw=t(l)}catch(g){var h;null===(h=s.errors)||void 0===h||h.push(L(g,"Error in message body"))}else null===(r=s.errors)||void 0===r||r.push(L(t,"Error in message body"));if(e.attachments.forEach((function(e){var a,t,n=new RegExp('(<img[^<>]*)"'.concat(G(e.filename),'"([^<>]*>)'),"g"),l=new RegExp("!\\[([^[\\]]*)\\]\\(".concat(G(e.filename),"\\)"),"g");n.test(s.raw)&&(s.raw=null===(a=s.raw)||void 0===a?void 0:a.replaceAll(n,'$1"cid:'.concat(e.cid,'"$2')),s.attachments.push(Object(A.a)(Object(A.a)({},e),{},{contentDisposition:"inline"})));l.test(s.raw)&&(s.raw=null===(t=s.raw)||void 0===t?void 0:t.replaceAll(l,"![$1](cid:".concat(e.cid,")")),s.attachments.push(Object(A.a)(Object(A.a)({},e),{},{contentDisposition:"inline"})))})),e.headers&&(s.headers=e.headers),"function"===typeof n)try{var f=n(l);f&&(s.attachmentNames=f)}catch(g){var v;null===(v=s.errors)||void 0===v||v.push(L(g,"Error in attachment names"))}else null===(c=s.errors)||void 0===c||c.push(L(n,"Error in attachment names"));return s.attachmentNames&&s.attachmentNames.split(",").map((function(e){return e.trim()})).forEach((function(a){var t,n=e.attachments.find((function(e){return e.filename===a}));n?s.attachments.push(Object(A.a)(Object(A.a)({},n),{},{contentDisposition:"attachment"})):null===(t=s.errors)||void 0===t||t.push(Error("Could not find attachment with name ".concat(a)))})),function(e){var a=Object(A.a)({},e);if(e.raw&&e.bodyFormat===E.MARKDOWN){var t=T()(e.raw,R);a.html=C.a.sanitize(t),a.text=M.a.fromString(a.html,I)}e.raw&&e.bodyFormat===E.HTML&&(a.html=C.a.sanitize(e.raw),a.text=M.a.fromString(a.html,I));e.raw&&e.bodyFormat===E.PLAINTEXT&&(a.text=e.raw);e.raw||(a.text="");a.html&&Object(O.a)(a.html.matchAll(/src="(?!cid:)([^"]*)"/g)).forEach((function(e){var t;null===(t=a.errors)||void 0===t||t.push(Error("Could not find attachment with name ".concat(e[1])))}));return a.bodyFormat=E.PROCESSED,a}(s)}}function H(e){if(!e)return function(){return""};try{return Function("SPAM","return `".concat(e,"`"))}catch(a){return a}}function L(e,a){var t=Error(e.toString());return t.name=a,t}var W={bodyFormat:E.MARKDOWN,attachments:[]},$=Object(h.b)({name:"template",initialState:W,reducers:{setHost:function(e,a){e.host=a.payload},setMessageFormat:function(e,a){e.bodyFormat=a.payload},setRawBody:function(e,a){e.raw=a.payload},setHeader:function(e,a){e[a.payload.header]=a.payload.value},setAttachmentNames:function(e,a){e.attachmentNames=a.payload},addAttachments:function(e,a){var t;(t=e.attachments).push.apply(t,Object(O.a)(a.payload))}}}),V=$.reducer,B=$.actions,K=B.setHost,Q=B.setMessageFormat,X=B.setRawBody,z=B.setHeader,Y=B.setAttachmentNames,J=B.addAttachments;function q(e){return e.template.host}function Z(e){return e.template}function ee(e){return e.template.bodyFormat}function ae(e){return e.template.raw}function te(e){return e.template.attachmentNames}function ne(e){return e.template.attachments}function le(e){return function(a){return a.template[e]}}function re(){var e=Object(n.useState)(!1),a=Object(s.a)(e,2),t=a[0],r=a[1],c=Object(p.b)(),i=Object(p.c)(q),m=Object(p.c)(le("from")),o=Object(p.c)(le("to")),u=Object(p.c)(le("cc")),d=Object(p.c)(le("bcc")),h=Object(p.c)(le("replyTo")),f=Object(p.c)(le("sender")),v=Object(p.c)(le("inReplyTo")),g=Object(p.c)(le("subject")),N=Object(p.c)(ee),b=Object(p.c)(ae),y=Object(p.c)(te);return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control"},l.a.createElement("label",{className:"label"},"From"),l.a.createElement("input",{className:"input",type:"text",value:m||"",placeholder:"Your Name <example@mit.edu>",onChange:function(e){return c(z({header:"from",value:e.target.value}))}}),l.a.createElement("p",{className:"help"},"Should be an @mit.edu or @esp.mit.edu address"))),l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control"},l.a.createElement("label",{className:"label"},"To"),l.a.createElement("input",{className:"input",type:"text",value:o||"",placeholder:"${SPAM.email}",onChange:function(e){return c(z({header:"to",value:e.target.value}))}}),l.a.createElement("p",{className:"help"},"Main recipients of your message"))),l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control"},l.a.createElement("label",{className:"label"},"Cc"),l.a.createElement("input",{className:"input",type:"text",value:u||"",placeholder:"test1@example.com, test2@example.com",onChange:function(e){return c(z({header:"cc",value:e.target.value}))}}),l.a.createElement("p",{className:"help"},"Additional recipients of your message"))),!t&&l.a.createElement("div",{className:"has-text-centered"},l.a.createElement("a",{onClick:function(e){r(!0),e.preventDefault()}},"Show additional fields...")),t&&l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"has-text-centered"},l.a.createElement("a",{onClick:function(e){r(!1),e.preventDefault()}},"Hide additional fields...")),l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control"},l.a.createElement("label",{className:"label"},"Host"),l.a.createElement("select",{className:"input",value:i||"",placeholder:"outgoing.mit.edu",onChange:function(e){return c(K(e.target.value))}},l.a.createElement("option",{value:"outgoing.mit.edu"},"outgoing.mit.edu"),l.a.createElement("option",{value:"esp-mail.mit.edu"},"esp-mail.mit.edu")),l.a.createElement("p",{className:"help"},"Email server to send through; if esp-mail.mit.edu, From field should be an @esp.mit.edu address"))),l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control"},l.a.createElement("label",{className:"label"},"Bcc"),l.a.createElement("input",{className:"input",type:"text",value:d||"",placeholder:"test3@example.com",onChange:function(e){return c(z({header:"bcc",value:e.target.value}))}}),l.a.createElement("p",{className:"help"},"Additional hidden recipients of your message"))),l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control"},l.a.createElement("label",{className:"label"},"Reply-To"),l.a.createElement("input",{className:"input",type:"text",value:h||"",onChange:function(e){return c(z({header:"replyTo",value:e.target.value}))}}),l.a.createElement("p",{className:"help"},"Optional email address that you want people to send replies to"))),l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control"},l.a.createElement("label",{className:"label"},"Sender"),l.a.createElement("input",{className:"input",type:"text",value:f||"",onChange:function(e){return c(z({header:"sender",value:e.target.value}))}}),l.a.createElement("p",{className:"help"},"If From is not an @mit.edu / @esp.mit.edu address, set this to an @mit.edu / @esp.mit.edu address to send on behalf of an external address"))),l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control"},l.a.createElement("label",{className:"label"},"In-Reply-To"),l.a.createElement("input",{className:"input",type:"text",value:v||"",onChange:function(e){return c(z({header:"inReplyTo",value:e.target.value}))}}),l.a.createElement("p",{className:"help"},"For replying to previous messages (leave blank if you don't know what this is)")))),l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control"},l.a.createElement("label",{className:"label"},"Subject"),l.a.createElement("input",{className:"input",type:"text",value:g||"",placeholder:"Automated spam message for ${SPAM.name}",onChange:function(e){return c(z({header:"subject",value:e.target.value}))}}))),l.a.createElement("div",{className:"field"},l.a.createElement("label",{className:"label"},"Message"),l.a.createElement("div",{className:"tabs is-toggle is-small mb-3"},l.a.createElement("ul",null,l.a.createElement("li",{className:N===E.MARKDOWN?"is-active":""},l.a.createElement("a",{onClick:function(e){c(Q(E.MARKDOWN)),e.preventDefault()}},"Markdown")),l.a.createElement("li",{className:N===E.HTML?"is-active":""},l.a.createElement("a",{onClick:function(e){c(Q(E.HTML)),e.preventDefault()}},"HTML")),l.a.createElement("li",{className:N===E.PLAINTEXT?"is-active":""},l.a.createElement("a",{onClick:function(e){c(Q(E.PLAINTEXT)),e.preventDefault()}},"Plain text")))),l.a.createElement("textarea",{className:"textarea",value:b||"",rows:20,placeholder:ce,onChange:function(e){return c(X(e.target.value))}})),l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"control"},l.a.createElement("label",{className:"label"},"Attachments"),l.a.createElement("input",{className:"input",type:"text",value:y||"",placeholder:"file1.png, file2.png",onChange:function(e){return c(Y(e.target.value))}}))))}var ce="\nDear ${SPAM.name},\n\nThis is a friendly reminder that your appointment is scheduled for **tomorrow** at ${SPAM.time}.\n\nIf you have any questions, please visit [our website](https://example.com).\n\nSincerely,<br>\nYour Name\n".trim(),se=t(8),ie={title:"",nextPage:function(){return!1},prevPage:function(){return!1},showNext:!1,showPrev:!1};function me(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie;return l.a.createElement("div",null,l.a.createElement("nav",{className:"container pt-5"},l.a.createElement("div",{className:"level is-mobile"},l.a.createElement("div",{className:"level-left has-text-centered"},l.a.createElement("button",{onClick:e.prevPage,className:"button is-success "+(e.showPrev?"":"is-invisible")},l.a.createElement("span",{className:"icon"},l.a.createElement(i.a,{icon:se.b,transform:"down-1"})),l.a.createElement("span",null,"Back"))),l.a.createElement("div",{className:"level-item"},l.a.createElement("div",{className:"title is-3 py-1"},e.title)),l.a.createElement("div",{className:"level-right has-text-centered"},l.a.createElement("button",{onClick:e.nextPage,className:"button is-success "+(e.showNext?"":"is-invisible")},l.a.createElement("span",null,"Next"),l.a.createElement("span",{className:"icon"},l.a.createElement(i.a,{icon:se.c,transform:"down-1"})))))),l.a.createElement("hr",null))}var oe="\nemail, name, time\naphacker@mit.edu, Alyssa P. Hacker, 9:00 AM\nbitdiddle@mit.edu, Ben Bitdiddle, 11:00 AM\npembroke@mit.edu, Edward S. Pembroke, 2:00 PM\n".trim();function ue(e){var a=Object(p.c)(S),t=Object(p.b)();return l.a.createElement(l.a.Fragment,null,l.a.createElement(me,{title:"Enter your data",nextPage:e.nextPage,prevPage:e.prevPage,showNext:!0,showPrev:!0}),l.a.createElement("div",null,l.a.createElement("div",{className:"container px-3 pb-3"},l.a.createElement("div",{className:"field"},l.a.createElement("label",{className:"label"},"Enter data as a tab- or comma-separated array. The first line should be a header row with variable names."),l.a.createElement("textarea",{className:"textarea",value:a||"",placeholder:oe,onChange:function(e){return t(x(e.target.value))},rows:20,autoFocus:!0,spellCheck:"false",wrap:"off"}),!a&&l.a.createElement("p",{className:"pt-1"},"(",l.a.createElement("a",{onClick:function(e){!function(e){e(x(oe)),e(z({header:"from",value:"Your Name <example@mit.edu>"})),e(z({header:"to",value:"${SPAM.email}"})),e(z({header:"subject",value:"Automated spam message for ${SPAM.name}"})),e(Q(E.MARKDOWN)),e(X(ce))}(t),e.preventDefault()}},"Click here to load sample data and message"),")")),l.a.createElement(de,null))))}function de(){var e=Object(p.c)(P),a=e.headers,t=e.rows,n=a.filter((function(e){return U.includes(e)}));return l.a.createElement(l.a.Fragment,null,!!(null===a||void 0===a?void 0:a.length)&&l.a.createElement("div",{className:"py-3"},l.a.createElement("p",{className:"label"},"Preview"),l.a.createElement("div",{className:"table-container mb-2"},l.a.createElement("table",{className:"table is-bordered is-hoverable"},l.a.createElement("thead",{className:"has-background-light"},l.a.createElement("tr",null,a.map((function(e,a){return l.a.createElement("th",{key:a},e)})))),l.a.createElement("tbody",null,null===t||void 0===t?void 0:t.map((function(e,a){return l.a.createElement("tr",{key:a},e.map((function(e,a){return l.a.createElement("td",{key:a},e)})))}))))),l.a.createElement("p",null,"Number of emails: ",(null===t||void 0===t?void 0:t.length)||0),n.length>0&&l.a.createElement("div",{className:"pt-5"},n.map((function(e,a){return l.a.createElement("div",{key:a,className:"message is-danger"},l.a.createElement("div",{className:"message-body"},l.a.createElement("span",{className:"has-text-weight-bold"},e)," is a special keyword. Please choose a different variable name."))})))))}var Ee,pe=t(36);function he(e){var a="has-text-weight-bold",t="has-text-grey-light",n={from:e.message.from||"(empty)",fromClass:e.message.from?"":t,to:e.message.to||"(empty)",toClass:e.message.to?"":t,subject:e.message.subject||"(empty)",subjectClass:e.message.subject?"":t},r=e.message.attachments.filter((function(e){return"attachment"===e.contentDisposition})),c=e.message.html;e.message.attachments.forEach((function(e){var a;"inline"===e.contentDisposition&&(c=null===(a=c)||void 0===a?void 0:a.replaceAll("cid:".concat(e.cid),"data:".concat(e.contentType,";base64,").concat(e.content)))}));var s=(e.message.errors||[]).concat(e.additionalErrors||[]);return l.a.createElement("div",null,l.a.createElement("div",{className:"add-paragraph-spacing"},l.a.createElement("p",null,l.a.createElement("span",{className:a},"From:")," ",l.a.createElement("span",{className:n.fromClass},n.from)),l.a.createElement("p",null,l.a.createElement("span",{className:a},"To:")," ",l.a.createElement("span",{className:n.toClass},n.to)),e.message.cc&&l.a.createElement("p",null,l.a.createElement("span",{className:a},"Cc:")," ",e.message.cc),e.message.bcc&&l.a.createElement("p",null,l.a.createElement("span",{className:a},"Bcc:")," ",e.message.bcc),e.message.replyTo&&l.a.createElement("p",null,l.a.createElement("span",{className:a},"Reply-To:")," ",e.message.replyTo),e.message.sender&&l.a.createElement("p",null,l.a.createElement("span",{className:a},"Sender:")," ",e.message.sender),e.message.inReplyTo&&l.a.createElement("p",null,l.a.createElement("span",{className:a},"In-Reply-To:")," ",e.message.inReplyTo),e.message.references&&l.a.createElement("p",null,l.a.createElement("span",{className:a},"References:")," ",e.message.references),l.a.createElement("p",null,l.a.createElement("span",{className:a},"Subject:")," ",l.a.createElement("span",{className:n.subjectClass},n.subject)),e.message.messageId&&l.a.createElement("p",null,l.a.createElement("span",{className:a},"Message-ID:")," ",e.message.messageId),e.message.date&&l.a.createElement("p",null,l.a.createElement("span",{className:a},"Date:")," ",e.message.date)),l.a.createElement("div",{className:"pt-3 break-overflow"},c&&l.a.createElement("div",{className:"content",dangerouslySetInnerHTML:{__html:c}}),!e.message.html&&e.message.text&&l.a.createElement("pre",{className:"wrap-text"},e.message.text),!e.message.html&&!e.message.text&&l.a.createElement("p",{className:t},"(message is blank)")),r.length>0&&l.a.createElement("div",{className:"pt-3 content break-overflow"},l.a.createElement("b",null,"Attachments:"),l.a.createElement("ul",null,r.map((function(e,a){return l.a.createElement("li",{key:a},e.filename)})))),s.length>0&&l.a.createElement("div",{className:"pt-5"},s.map((function(e,t){return l.a.createElement("div",{key:t,className:"message is-danger"},l.a.createElement("div",{className:"message-body"},e.name&&l.a.createElement("span",{className:a},"[",e.name,"] "),e.message))}))))}function fe(){var e=Object(p.c)(Z),a=Object(p.c)(P),t=Object(n.useMemo)((function(){return F(e)}),[e])(Object(n.useMemo)((function(){return _(a,0)}),[a]));return l.a.createElement(he,{message:t})}function ve(){return l.a.createElement("div",{className:"content"},l.a.createElement("h3",null,"Inserting variables"),l.a.createElement("p",null,"In your data, each value in the header row defines a variable name. The spam script generates one email for each subsequent row of data."),l.a.createElement("p",null,"Variables are stored in the ",l.a.createElement("code",null,"SPAM")," object, and substitutions are done using ",l.a.createElement("code",null,"${}")," syntax. You can insert a variable named ",l.a.createElement("code",null,"xyz")," into your email by writing"," ",l.a.createElement("code",null,"${SPAM.xyz}")," or by writing"," ",l.a.createElement("code",null,'${SPAM["xyz"]}'),". The latter syntax is necessary if your variable name contains special characters like spaces."),l.a.createElement("p",null,"The message that you write is evaulated as a Javascript"," ",l.a.createElement("a",{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals",target:"_blank",rel:"noopener noreferrer"},"template literal"),". You can include arbitrary Javascript code inside the"," ",l.a.createElement("code",null,"${}")," expressions."),l.a.createElement("p",null,"In addition, you can access non-named data entries by index via the special value of ",l.a.createElement("code",null,"SPAM.ARGV"),", an array that contains the entire data row. This can be used to generate things like variable-length tables inside your email."),l.a.createElement("h3",null,"Special characters"),l.a.createElement("ul",null,l.a.createElement("li",null,"To insert a literal backslash (",l.a.createElement("code",null,"\\"),"), write ",l.a.createElement("code",null,"\\\\"),"."),l.a.createElement("li",null,"To insert a literal backtick (",l.a.createElement("code",null,"`"),"), write ",l.a.createElement("code",null,"\\`"),"."),l.a.createElement("li",null,"To insert a literal ",l.a.createElement("code",null,"${"),", escape the dollar sign like this: ",l.a.createElement("code",null,"\\${}"),"."),l.a.createElement("li",null,"To insert a special Unicode code point, use"," ",l.a.createElement("code",null,"\\u{XXXXX}"),".")),l.a.createElement("h3",null,"Markdown"),l.a.createElement("p",null,"If you are using Markdown mode, you can apply formatting to your message with"," ",l.a.createElement("a",{href:"https://www.markdownguide.org/cheat-sheet/",target:"_blank",rel:"noopener noreferrer"},"Markdown syntax"),". The table below shows a few commonly used elements."),l.a.createElement("table",{className:"table is-bordered is-hoverable fixed-table"},l.a.createElement("thead",{className:"has-background-light"},l.a.createElement("tr",null,l.a.createElement("th",null,"Markdown"),l.a.createElement("th",null,"Result"))),l.a.createElement("tbody",null,l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("code",null,"# Heading 1")),l.a.createElement("td",{className:"title is-4 mx-0 my-0"},"Heading 1")),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("code",null,"## Heading 2")),l.a.createElement("td",{className:"title is-5"},"Heading 2")),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("code",null,"*Italic*")),l.a.createElement("td",null,l.a.createElement("em",null,"Italic"))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("code",null,"**Bold**")),l.a.createElement("td",{className:"has-text-weight-bold"},"Bold")),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("code",null,"~~Strikethrough~~")),l.a.createElement("td",null,l.a.createElement("s",null,"Strikethrough"))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("code",null,"* List")),l.a.createElement("td",null,l.a.createElement("ul",{className:"mx-4 my-0"},l.a.createElement("li",null,"List")))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("code",null,"\\`Code\\`")),l.a.createElement("td",null,l.a.createElement("code",null,"Code"))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("code",null,"[Link](https://example.com)")),l.a.createElement("td",null,l.a.createElement("a",{href:"https://example.com",target:"_blank",rel:"noopener noreferrer"},"Link"))),l.a.createElement("tr",null,l.a.createElement("td",null,l.a.createElement("code",null,"![Image](filename.jpg)")),l.a.createElement("td",null,l.a.createElement("img",{alt:"",src:"https://picsum.photos/100"}))))),l.a.createElement("p",null,"Because template literal evaluation occurs before Markdown parsing, you'll need to escape backticks and other special characters that are part of your Markdown. For example, writing"," ",l.a.createElement("code",null,"\\`Code\\`")," will result in the Markdown expression"," ",l.a.createElement("code",null,"`Code`"),"."))}function ge(){var e=Object(n.useState)(!1),a=Object(s.a)(e,2),t=a[0],r=a[1],c=Object(p.b)(),m=Object(p.c)(ne),o=function(e){return new Promise((function(a,t){var n=new FileReader;n.onloadend=function(){var l=n.result;"string"===typeof l?a({filename:e.name,contentType:e.type,contentTransferEncoding:"base64",cid:"".concat(e.name.replace(/[^a-z0-9.]/gi,""),"@esp.mit.edu"),content:l.split(",")[1]}):t()},n.readAsDataURL(e)}))};return l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"field"},l.a.createElement("div",{className:"file"},l.a.createElement("label",{className:"file-label"},l.a.createElement("input",{className:"file-input",type:"file",multiple:!0,onChange:function(e){var a=e.target.files;a&&(r(!0),Promise.all(Object(O.a)(a).map(o)).then((function(e){c(J(e)),r(!1)})))}}),l.a.createElement("span",{className:"file-cta"},l.a.createElement("span",{className:"file-icon"},l.a.createElement(i.a,{icon:se.h,fixedWidth:!0})),l.a.createElement("span",{className:"file-label"},"Choose files\u2026"))))),new Set(m.map((function(e){return e.cid}))).size!==m.length?l.a.createElement("div",{className:"message is-warning"},l.a.createElement("div",{className:"message-header"},l.a.createElement("p",null,"Warning")),l.a.createElement("div",{className:"message-body"},"Filenames should be distinct! No promises what'll happen when they aren't.")):null,l.a.createElement("div",{className:"content"},l.a.createElement("h3",null,"Filenames:"),l.a.createElement("ul",null,t?l.a.createElement("li",{className:"has-text-grey-light"},"(loading...)"):0===m.length?l.a.createElement("li",{className:"has-text-grey-light"},"(none selected)"):m.map((function(e,a){return l.a.createElement("li",{key:a},e.filename)})))))}!function(e){e[e.PREVIEW=0]="PREVIEW",e[e.HELP=1]="HELP",e[e.ATTACHMENTS=2]="ATTACHMENTS"}(Ee||(Ee={}));var Ne,be=Ee.PREVIEW;function ye(e){var a=Object(n.useState)(be),t=Object(s.a)(a,2),r=t[0],c=t[1];return l.a.createElement(l.a.Fragment,null,l.a.createElement(me,{title:"Write your message",nextPage:e.nextPage,prevPage:e.prevPage,showNext:!0,showPrev:!0}),l.a.createElement("div",{className:"fill-height"},l.a.createElement("div",{className:"container px-3 pb-3 fullheight-container"},l.a.createElement("div",{className:"columns is-desktop is-variable is-4 my-0 fullheight-container"},l.a.createElement("div",{className:"column"},l.a.createElement("div",{className:"fullheight-column"},l.a.createElement("div",{className:"scrollable"},l.a.createElement(re,null)))),l.a.createElement("div",{className:"column fullheight-container"},l.a.createElement("div",{className:"card fullheight-card"},l.a.createElement("nav",{className:"card-footer"},l.a.createElement("div",{className:"card-footer-item tabs is-fullwidth pt-1"},l.a.createElement("ul",null,l.a.createElement("li",{className:r===Ee.PREVIEW?"is-active":""},l.a.createElement("a",{onClick:function(e){c(Ee.PREVIEW),e.preventDefault()}},l.a.createElement("span",{className:"icon"},l.a.createElement(i.a,{icon:pe.a,fixedWidth:!0})),l.a.createElement("span",null,"Preview"))),l.a.createElement("li",{className:r===Ee.HELP?"is-active":""},l.a.createElement("a",{onClick:function(e){c(Ee.HELP),e.preventDefault()}},l.a.createElement("span",{className:"icon"},l.a.createElement(i.a,{icon:pe.b,fixedWidth:!0})),l.a.createElement("span",null,"Help"))),l.a.createElement("li",{className:r===Ee.ATTACHMENTS?"is-active":""},l.a.createElement("a",{onClick:function(e){c(Ee.ATTACHMENTS),e.preventDefault()}},l.a.createElement("span",{className:"icon"},l.a.createElement(i.a,{icon:se.e,transform:"shrink-1",fixedWidth:!0})),l.a.createElement("span",null,"Attachments")))))),l.a.createElement("div",{className:"card-content pt-3 fill-height"},l.a.createElement("div",{className:"fullheight-column"},l.a.createElement("div",{className:"scrollable"},r===Ee.PREVIEW&&l.a.createElement(fe,null),r===Ee.HELP&&l.a.createElement(ve,null),r===Ee.ATTACHMENTS&&l.a.createElement(ge,null))))))))))}!function(e){e[e.UNSENT=0]="UNSENT",e[e.QUEUED=1]="QUEUED",e[e.SENDING=2]="SENDING",e[e.SUCCESS=3]="SUCCESS",e[e.ERROR=4]="ERROR"}(Ne||(Ne={}));var we,xe=Object(h.b)({name:"sending",initialState:[],reducers:{setSendingState:function(e,a){e.length=0,e.push.apply(e,Object(O.a)(a.payload))},setMessage:function(e,a){e[a.payload.index]&&(e[a.payload.index].message=a.payload.message)},setStatus:function(e,a){e[a.payload.index]&&(e[a.payload.index].status=a.payload.status,a.payload.status===Ne.SUCCESS&&(e[a.payload.index].error=void 0))},setError:function(e,a){e[a.payload.index]&&(e[a.payload.index].status=Ne.ERROR,e[a.payload.index].error=a.payload.error)},setShowPreview:function(e,a){void 0===a.payload.index?e.forEach((function(e){return e.showPreview=a.payload.showPreview})):e[a.payload.index]&&(e[a.payload.index].showPreview=a.payload.showPreview)},sendMessages:function(e){e.map((function(e){return e.status})).map((function(e,a){return function(e){return e===Ne.UNSENT||e===Ne.ERROR}(e)?a:-1})).filter((function(e){return-1!==e})).forEach((function(a){return e[a].status=Ne.QUEUED}))},cancelSending:function(e){e.map((function(e){return e.status})).map((function(e,a){return e===Ne.QUEUED||e===Ne.SENDING?a:-1})).filter((function(e){return-1!==e})).forEach((function(a){return e[a].status=Ne.UNSENT}))}}}),Se=xe.reducer,Pe=xe.actions,Oe=Pe.setSendingState,Ae=(Pe.setMessage,Pe.setStatus),je=Pe.setError,Te=Pe.setShowPreview,ke=Pe.sendMessages,Ce=Pe.cancelSending;function De(){return function(e,a){var t=a(),n=Z(t),l=P(t),r=F(n),c=function(e){return e.rows.map((function(a,t){return _(e,t)}))}(l).map(r).map((function(e){return{message:e,status:Ne.UNSENT,showPreview:!1}}));e(Oe(c))}}function Me(e){var a,t;return null===(a=e.sending[0])||void 0===a||null===(t=a.message)||void 0===t?void 0:t.host}function Re(e){return e.sending.map((function(e){return e.status}))}function Ie(e){var a,t=Object(p.c)((a=e.index,function(e){return e.sending[a]})),n=t.message,r=t.status,c=t.showPreview,s=t.error,m=Object(p.b)(),o=[n.to,n.cc,n.bcc].filter((function(e){return null===e||void 0===e?void 0:e.trim()})).join(", "),u=function(e){switch(e){case Ne.UNSENT:return pe.a;case Ne.QUEUED:case Ne.SENDING:return se.f;case Ne.SUCCESS:return se.d;case Ne.ERROR:return se.g}}(r),d=function(e){switch(e){case Ne.SUCCESS:return"has-text-success";case Ne.ERROR:return"has-text-danger";case Ne.SENDING:return"has-text-info";default:return""}}(r),E=function(e){switch(e){case Ne.UNSENT:return"Not yet sent";case Ne.QUEUED:return"Queued for sending";case Ne.SENDING:return"Sending in progress";case Ne.SUCCESS:return"Delivered";case Ne.ERROR:return"Error"}}(r),h=r===Ne.QUEUED||r===Ne.SENDING;return l.a.createElement("div",{className:"card"},l.a.createElement("div",{className:"card-header"},l.a.createElement("div",{className:"card-header-title"},l.a.createElement("span",{className:"icon mr-3 ".concat(d),title:E},l.a.createElement(i.a,{icon:u,fixedWidth:!0,pulse:h})),o,!o&&l.a.createElement("span",{className:"has-text-danger"},"Message has no recipients!"),n.errors&&n.errors.length>0&&l.a.createElement(l.a.Fragment,null,"\xa0",l.a.createElement("span",{className:"tag is-warning is-light"},"Message error")),r===Ne.ERROR&&l.a.createElement(l.a.Fragment,null,"\xa0",l.a.createElement("span",{className:"tag is-danger is-light"},"Sending error"))),l.a.createElement("div",{className:"card-header-icon",onClick:function(){m(Te({index:e.index,showPreview:!c}))}},l.a.createElement("span",{className:"icon"},l.a.createElement(i.a,{icon:se.a,fixedWidth:!0})))),c&&l.a.createElement("div",{className:"card-content"},l.a.createElement(he,{message:n,additionalErrors:s?[s]:[]})))}function Ue(e){var a=Object(p.c)(Re),t=Object(p.c)(Me),r=Object(p.b)(),c=a.length,s=a.filter((function(e){return e===Ne.SUCCESS})).length,m=c-s,o=a.filter((function(e){return e===Ne.ERROR})).length,d=s===c,E=a.some((function(e){return e===Ne.QUEUED||e===Ne.SENDING})),h=!E&&(0===s||d);return Object(n.useEffect)((function(){r(De())}),[]),Object(n.useEffect)((function(){c>0&&d&&Object(u.a)()}),[c,d]),l.a.createElement(l.a.Fragment,null,0===c&&l.a.createElement("div",{className:"hero is-fullheight"},l.a.createElement("div",{className:"hero-header"},l.a.createElement(me,{title:"Send your spam",prevPage:e.prevPage,showNext:!1,showPrev:h})),l.a.createElement("div",{className:"hero-body"},l.a.createElement("div",{className:"container has-text-centered pb-6"},l.a.createElement("div",{className:"huge-icon"},l.a.createElement("span",{role:"img","aria-label":"icon"},"\ud83d\udced")),l.a.createElement("p",{className:"title has-text-grey-dark"},"No messages to send!")))),c>0&&l.a.createElement("div",null,l.a.createElement(me,{title:"Send your spam",prevPage:e.prevPage,showNext:!1,showPrev:h}),l.a.createElement("div",null,l.a.createElement("div",{className:"container px-3 pb-5"},!u.b&&l.a.createElement("div",{className:"message is-warning"},l.a.createElement("div",{className:"message-body"},l.a.createElement("strong",null,"You are using a non-functional demo.")," All results here are simulated, and no actual emails will be sent.")),c>=250&&"esp-mail.mit.edu"!==t&&l.a.createElement("div",{className:"message is-danger"},l.a.createElement("div",{className:"message-body"},l.a.createElement("strong",null,"You are sending more than 250 emails.")," MIT emails are limited to sending 500 messages per 24 hours without prior permission from IS&T. Do you really need to be using the spam script, or can you send this using a mailing list, the comm panel, or bcc'ing people?")),c>=250&&"esp-mail.mit.edu"===t&&l.a.createElement("div",{className:"message is-warning"},l.a.createElement("div",{className:"message-body"},l.a.createElement("strong",null,"You are sending more than 250 emails.")," ","Sending to large numbers of people is not well-tested.")),l.a.createElement("div",{className:"level pb-2"},l.a.createElement("div",{className:"level-item has-text-centered"},l.a.createElement("div",null,l.a.createElement("p",{className:"title is-1"},m),l.a.createElement("p",{className:"heading"},"Not sent"))),l.a.createElement("div",{className:"level-item has-text-centered"},l.a.createElement("div",null,l.a.createElement("p",{className:"title is-1"},s),l.a.createElement("p",{className:"heading"},"Delivered"))),l.a.createElement("div",{className:"level-item has-text-centered"},l.a.createElement("div",null,l.a.createElement("p",{className:"title is-1 ".concat(o>0?"has-text-danger":"")},o),l.a.createElement("p",{className:"heading"},"Errors"))),l.a.createElement("div",{className:"level-item has-text-centered"},d&&l.a.createElement("div",null,l.a.createElement("span",{className:"icon is-large has-text-success"},l.a.createElement(i.a,{icon:se.d,size:"3x"})),l.a.createElement("p",{className:"heading pt-1"},"All done!")),E&&l.a.createElement("div",null,l.a.createElement("button",{className:"button is-medium is-outlined is-warning",onClick:function(){return r(Ce())}},"Pause"),l.a.createElement("p",{className:"heading pt-1"},"Click to pause")),!d&&!E&&l.a.createElement("div",null,l.a.createElement("button",{className:"button is-medium is-success",onClick:function(){return r(ke())}},"Spam!"),l.a.createElement("p",{className:"heading pt-1"},o>0?"Click to (re)send":"Click to send")))),l.a.createElement("div",{className:"level is-mobile mb-2"},l.a.createElement("div",{className:"level-left"},l.a.createElement("p",{className:"subtitle is-5 mt-1"},"You have ".concat(c," email message").concat(c>1?"s":"","."))),l.a.createElement("div",{className:"level-right"},l.a.createElement("div",{className:"buttons has-addons"},l.a.createElement("button",{className:"button is-small",onMouseDown:function(e){r(Te({showPreview:!0})),e.preventDefault()}},"Expand all"),l.a.createElement("button",{className:"button is-small",onMouseDown:function(e){r(Te({showPreview:!1})),e.preventDefault()}},"Collapse all")))),a.map((function(e,a){return l.a.createElement(Ie,{key:a,index:a})}))))))}!function(e){e[e.MAIN_PAGE=0]="MAIN_PAGE",e[e.DATA_PAGE=1]="DATA_PAGE",e[e.MESSAGE_PAGE=2]="MESSAGE_PAGE",e[e.SEND_PAGE=3]="SEND_PAGE"}(we||(we={}));var Ge=we.MAIN_PAGE;function _e(){var e=Object(n.useState)(Ge),a=Object(s.a)(e,2),t=a[0],r=a[1];switch(t){case we.MAIN_PAGE:return l.a.createElement(d,{nextPage:function(){Object(u.c)(),r(we.DATA_PAGE)}});case we.DATA_PAGE:return l.a.createElement(ue,{prevPage:function(){return r(we.MAIN_PAGE)},nextPage:function(){return r(we.MESSAGE_PAGE)}});case we.MESSAGE_PAGE:return l.a.createElement(ye,{prevPage:function(){return r(we.DATA_PAGE)},nextPage:function(){return r(we.SEND_PAGE)}});case we.SEND_PAGE:return l.a.createElement(Ue,{prevPage:function(){return r(we.MESSAGE_PAGE)}})}}var Fe=t(218),He=t(221),Le=t(216),We=t(102),$e=t(222),Ve=t(48),Be=t(213),Ke=t(214),Qe=t(215),Xe=t(44),ze=t(217),Ye=t(223),Je=t(219),qe=t(220);function Ze(e){return u.b?function(e){return Object(Ye.a)({url:"./backend/sendmail.py",method:"POST",headers:{"Content-Type":"application/json"},body:e,withCredentials:!0}).pipe(Object(Xe.a)((function(e){return e.response.status?e.response:{status:"error",message:"Did not receive valid response from API"}})))}(e):function(e){var a=Math.random()<.5,t=[e.to,e.cc,e.bcc].filter((function(e){return null===e||void 0===e?void 0:e.trim()})).join(", ");return Object(Ve.a)({status:a?"error":"success",message:a?"This is a fake error that occurs with 50% probability":""}).pipe(Object(Je.a)(1e3),Object(qe.a)((function(){a?console.log("Fake API: encountered a fake error"):console.log("Fake API: sent message to ".concat(t))})))}(e)}var ea=[function(e,a){return e.pipe(Object(Be.a)(ke.match),Object(Ke.a)(a),Object(Qe.a)((function(t){var n=Object(s.a)(t,2),l=(n[0],n[1]);return Object(We.a)(Re(l).map((function(e,a){return e===Ne.QUEUED?a:-1})).filter((function(e){return-1!==e}))).pipe(Object(Ke.a)(a),Object(Qe.a)((function(e){var a=Object(s.a)(e,2),t=a[0],n=a[1];return Object($e.a)(Object(Ve.a)(Ae({index:t,status:Ne.SENDING})),Ze(function(e){return function(a){return a.sending[e].message}}(t)(n)).pipe(Object(Xe.a)((function(e){return function(e,a){if("success"===a.status)return Ae({index:e,status:Ne.SUCCESS});var t=a.message||a.status;return je({index:e,error:{name:"Server responded with ".concat(a.status),message:t}})}(t,e)})),Object(Le.a)((function(e){return Object(Ve.a)(je({index:t,error:{name:e.name,message:e.message}}))}))))})),Object(ze.a)(e.pipe(Object(Be.a)(Ce.match))))})))}],aa=Object(Fe.a)(),ta=function(e,a,t){return He.a.apply(void 0,ea)(e,a,t).pipe(Object(Le.a)((function(e,a){return console.error(e),a})))};var na=function(){var e=Object(h.a)({reducer:{data:N,template:V,sending:Se},middleware:function(e){return e().prepend(aa)}});return aa.run(ta),e}();c.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(p.a,{store:na},l.a.createElement(_e,null))),document.getElementById("root"))}},[[103,1,2]]]);
//# sourceMappingURL=main.50bd4f88.chunk.js.map